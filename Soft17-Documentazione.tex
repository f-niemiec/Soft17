\documentclass[a4paper,11pt]{article}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{amsmath}
\usepackage{enumitem}

\title{Soft17 -- An Intelligent Agent for Blackjack}
\author{Abbatiello Simone, Nappi Vincenzo, Niemiec Francesco}
\date{January 2025}

\begin{document}

\maketitle

\section{Introduzione}

\subsection{Genesi del progetto}

Durante la seconda parte del corso di \textit{Fondamenti di Intelligenza Artificiale}, in particolare quella dedicata agli argomenti di \textbf{Machine Learning}, è emerso in modo sempre più evidente il forte legame tra le tecniche di apprendimento automatico e il mondo della statistica.  

Abbiamo deciso di cogliere l’occasione offerta dallo sviluppo del progetto finale per approfondire tale correlazione, analizzandola in un contesto applicativo concreto. In seguito a una fase di brainstorming, volta a individuare un dominio che consentisse di unire questi due ambiti, abbiamo preso in considerazione i documenti forniti dal docente, nei quali il tema dei \textit{giochi} emerge come un caso di studio ricorrente.  

Guidati dalla curiosità e dalla relativa semplicità delle regole, abbiamo quindi scelto il gioco del \textbf{Blackjack}. Da questa scelta nasce l’idea di sviluppare un agente intelligente in grado di giocare autonomamente a Blackjack, prendendo decisioni razionali sulla base delle informazioni disponibili.

\section{Descrizione dell’agente}

\subsection{Obiettivi}

L’obiettivo del progetto è lo sviluppo di un \textbf{agente intelligente} in grado di:

\begin{itemize}
    \item selezionare, per ogni mano osservabile, l’azione più appropriata al fine di massimizzare il \textit{win rate}. Le azioni considerate sono:
    \begin{itemize}
        \item \textbf{Hit}: richiedere una carta aggiuntiva;
        \item \textbf{Stand}: mantenere la mano attuale;
        \item \textbf{Double}: raddoppiare la puntata iniziale e ricevere una sola carta;
        \item \textbf{Split}: dividere la mano in due mani distinte in presenza di due carte uguali.
    \end{itemize}
    \item prendere decisioni esclusivamente sulla base della propria mano e della carta scoperta del dealer, senza conoscere l’ordine delle carte rimanenti nel mazzo;
    \item migliorare le proprie prestazioni nel tempo, apprendendo dai dati osservati.
\end{itemize}

\subsection{Specifica dell’ambiente (PEAS)}

L’ambiente in cui opera l’agente viene descritto attraverso la specifica \textbf{PEAS} (Performance, Environment, Actuators, Sensors).

\begin{description}
    \item[Performance:] la misura di prestazione dell’agente è legata alla sua capacità di massimizzare il risultato economico nel gioco. In particolare vengono considerate il numero di vittorie rispetto alle mani giocate, il guadagno netto complessivo e la capacità di adottare azioni ottimali in situazioni rischiose.
    
    \item[Environment:] l’ambiente è rappresentato da un tavolo di Blackjack comprendente:
    \begin{itemize}
        \item uno o più mazzi di carte con distribuzione stocastica;
        \item un dealer che segue una policy fissa;
        \item la mano del giocatore;
        \item l’insieme delle regole del gioco.
    \end{itemize}
    Le proprietà dell’ambiente sono:
    \begin{itemize}
        \item \textbf{Parzialmente osservabile}: l’agente conosce solo la propria mano e la carta scoperta del dealer;
        \item \textbf{Stocastico}: l’ordine delle carte nel mazzo è pseudocasuale;
        \item \textbf{Sequenziale}: ogni azione influenza l’esito finale della mano;
        \item \textbf{Statico}: l’ambiente non cambia mentre l’agente sta deliberando;
        \item \textbf{Discreto}: il numero di stati e azioni è finito;
        \item \textbf{A singolo agente}: il dealer segue una strategia prefissata e non è considerato un agente decisionale.
    \end{itemize}

    \item[Actuators:] gli attuatori dell’agente corrispondono alle azioni disponibili: Hit, Stand, Double e Split.

    \item[Sensors:] l’agente percepisce:
    \begin{itemize}
        \item le carte della propria mano;
        \item la carta scoperta del dealer;
        \item le azioni consentite in un determinato stato (ad esempio la possibilità di effettuare double o split);
        \item l’esito finale della mano (vittoria, sconfitta o pareggio).
    \end{itemize}
\end{description}

\subsection{Scelta della strategia}

Un primo approccio al problema avrebbe potuto basarsi sulla teoria dei giochi e sull’utilizzo di algoritmi genetici. Tuttavia, tale soluzione presenta diverse criticità:

\begin{description}
    \item[Variabilità dei cromosomi:] la rappresentazione delle soluzioni risulterebbe altamente variabile, rendendo complessa la codifica delle strategie.
    \item[Complessità dello spazio di ricerca:] l’elevato numero di stati e azioni comporta uno spazio di ricerca estremamente ampio, con conseguenti tempi di elaborazione proibitivi.
    \item[Inaccuratezza della fitness:] la natura stocastica dell’ambiente rende la funzione di fitness fortemente influenzata dalla casualità.
\end{description}

Alla luce di queste considerazioni, abbiamo deciso di affrontare il problema tramite tecniche di \textbf{apprendimento supervisionato}. In questo contesto, l’agente apprende una funzione che associa a ogni stato osservabile del gioco un’etichetta nota, rappresentata dall’esito della mano, utilizzando un dataset di mani simulate.

\section{Raccolta, analisi e preprocessing dei dati}

\subsection{Scelta del dataset}

Per la costruzione del dataset sono state considerate due possibili strategie:
\begin{enumerate}
    \item Generare un dataset sintetico tramite un simulatore di Blackjack, in grado di produrre un numero arbitrario di mani realistiche (\url{https://www.kaggle.com/datasets/dennisho/blackjack-hands/data}).
    
    \item Utilizzare dataset già disponibili online (\url{https://www.kaggle.com/datasets/mojocolors/900000-hands-of-blackjack-results}).
\end{enumerate}


È stata scelta la prima opzione, in quanto consente un maggiore controllo sulla dimensione del dataset, sulla struttura delle feature e sulla distribuzione delle classi.

\subsection{Analisi e pulizia dei dati}

Il dataset generato non presenta valori mancanti. Tuttavia, è stato necessario effettuare una fase di \textit{data cleaning} al fine di garantire la coerenza semantica dei dati e la corretta rappresentazione delle variabili, rendendole idonee alle successive fasi di feature engineering e apprendimento automatico.

\end{document}
